const nPLPro={arr:[],compile:function(){let t=window.location.href.split("?")[0],e=this.arr.findIndex(e=>e.link.split("?")[0]===t);if(-1!==e){let n=e+1,i=e-1,r="",l="";n<this.arr.length&&(r=`<a href="${this.arr[n].link}">‹ Chapter trước</a>`),i>=0&&(l=`<a href="${this.arr[i].link}">Chapter sau ›</a>`),jQuery(".nPL-show").html(`<select onchange="location = this.value;" id="nPL_select">${this.arr.map((t,n)=>`<option value="${t.link}" ${n===e?"selected":""}>${t.title}</option>`).join("")}</select><div class="inner_nPL">${l}${r}</div>`)}},create:function(t,e=[]){Promise.all(e.map(e=>{let n=`/feeds/posts/summary/-/${t}?alt=json-in-script&start-index=${e}&max-results=150`;return jQuery.ajax({type:"get",url:n,dataType:"jsonp"}).promise()})).then(t=>{t.forEach(t=>{"entry"in t.feed&&t.feed.entry.forEach(t=>{let e=t.link.find(t=>"alternate"===t.rel).href.split("?")[0];this.arr.push({title:t.title.$t,link:e})})}),this.arr.length>0?this.compile():console.log("Error: no entries found.")}).catch(t=>console.log(t))},run:function(t,e=[]){"function"==typeof jQuery&&document.getElementById("nPL")?this.create(t,e):console.log("Error: not function or element not found.")}};
const clwd={arr:new Array,compile:function(){const t=this,e=this.arr.length;t.settings.title.some(e=>t.arr[0].title.includes(e.in))||t.arr.push(t.arr.shift());let n="<ul>",s='<div class="lastend">';jQuery.each(t.arr,function(i,a){let l=a.title;if(jQuery.each(t.settings.title,function(t,e){l.includes(e.in)&&(l=e.out+" "+l.split(e.in)[1].replace(/[^0-9\.-]+/g,""))}),i==e-2&&(s+=`<div class="inepcx" data-id="1"><a href="${a.link}"><span>cũ nhất</span><span class="epcur epcurfirst">${l}</span></a></div>`),0==i&&(s+=`<div class="inepcx" data-id="2"><a href="${a.link}"> <span>mới nhất</span> <span class="epcur epcurlast">${l}</span></a></div>`),i!=e-1){let t=0==a.dLink?"":`<div class="dt"> <a href="${a.dLink}" rel="nofollow" class="dload" target="_blank"><i class="fas fa-cloud-download-alt"></i></a></div>`;n+=`<li><div class="chbox"><div class="eph-num"><a href="${a.link}"><span class="chapternum">${l}</span> <span class="chapterdate">${a.published}</span></a></div>${t}</div></li>`}}),s+="</div>",n+="</ul>",document.getElementById("clwd").innerHTML=`${s+n}`},get:function(t){const e=this;t.ajax({url:`/feeds/posts/default/-/${this.settings.cat}?alt=json-in-script&start-index=${this.settings.start}&max-results=${this.settings.max}`,type:"get",dataType:"jsonp",success:function(n){"entry"in n.feed?(n.feed.entry.forEach(n=>{e.arr.push({title:n.title.$t,link:n.link.find(t=>"alternate"==t.rel).href,dLink:"content"in n&&(0!=t(n.content.$t).find("#downBTN").length&&t(n.content.$t).find("#downBTN").attr("href")),published:"function"==typeof timeAgo?timeAgo(new Date(n.updated.$t)):e.timeStirng(n.updated.$t)})}),n.feed.entry.length>=e.settings.max?(e.settings.start+=e.settings.max,e.run(e.settings.cat)):e.compile()):0!=e.arr.length&&e.compile()},error:function(t){console.log(t)}})},run:function(t){this.settings.cat=t,"function"==typeof jQuery&&document.getElementById("clwd")?this.get(jQuery):console.log("Output Nothing")},settings:{max:150,start:1,title:[{in:"Episode",out:"Ep."},{in:"Chapter",out:"Chapter"},{in:"Volume",out:"Vol."}],judul:"Chapter List"},timeStirng:function(t){if(/([12]\d{3}-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01]))/.test(t)){var e=t,n=e.substring(0,4),s=e.substring(5,7),i=e.substring(8,10),a=new Array;return a[1]="Jan",a[2]="Feb",a[3]="Mar",a[4]="Apr",a[5]="May",a[6]="Jun",a[7]="Jul",a[8]="Aug",a[9]="Sep",a[10]="Oct",a[11]="Nov",a[12]="Dec",i+" "+a[parseInt(s,10)]+" "+n}return!1}};
const limitHistory=100,histories=function(){function i(i,t,e){this.id=i,this.title=t,this.link=e}function t(){localStorage.setItem("History",JSON.stringify(list))}return list=[],null!=localStorage.getItem("History")&&(list=JSON.parse(localStorage.getItem("History"))),(obj={}).addHistory=function(e,s,l){var n=new i(e,s,l);if(null!=list){if(same=list.find(i=>i.id==e),list.length<100){if(same)for(let o in list)list[o].id===e&&list.splice(list.length,0,list.splice(o,1)[0]),t();else list.push(n),t()}else if(same)for(let r in list)list[r].id===e&&list.splice(list.length,0,list.splice(r,1)[0]),t();else list.splice(0,1),list.push(n),t()}else list.push(n),t()},obj}();
function timeAgo(t){var r=(new Date).getTime()-t.getTime(),e=Math.floor(r/1e3),n=Math.floor(e/60),c=Math.floor(n/60),o=Math.floor(c/24),i=Math.floor(o/30);return 0===r?"Vừa đăng l\xean":e<60?e+" Gi\xe2y trước":n<60?n+" Ph\xfat trước":c<24?c+" Giờ trước":o<30?o+" Ng\xe0y trước":i<12?i+" Th\xe1ng trước":Math.floor(i/12)+" Năm trước"}!function t(r){var e={prefix:"",suffix:"",seconds:"1 Gi\xe2y trước",seconds:"%d Gi\xe2y trước",minute:"1 Ph\xfat trước",minutes:"%d Ph\xfat trước",hour:"1 giờ trước",hours:"%d Giờ trước",day:"1 ng\xe0y trước",days:"%d Ng\xe0y trước",month:"1 th\xe1ng trước",months:"%d Th\xe1ng trước",year:"1 năm trước",years:"%d Năm trước"},n=function(t,r){return e[t]&&e[t].replace(/%d/i,Math.abs(Math.round(r)))},c=document.getElementsByClassName("timeago");for(var o in c){var i=c[o];"object"==typeof i&&(i.innerHTML=function(t){if(t){t=(t=(t=(t=t.replace(/\.\d+/,"")).replace(/-/,"/").replace(/-/,"/")).replace(/T/," ").replace(/Z/," UTC")).replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),t=new Date(1e3*t||t);var r=(new Date().getTime()-t)*.001>>0,c=r/60,o=c/60,i=o/24,a=i/365;return e.prefix+(r<45&&n("seconds",r)||r<90&&n("minute",1)||c<45&&n("minutes",c)||c<90&&n("hour",1)||o<24&&n("hours",o)||o<42&&n("day",1)||i<30&&n("days",i)||i<45&&n("month",1)||i<365&&n("months",i/30)||a<1.5&&n("year",1)||n("years",a))+e.suffix}}(i.getAttribute("title")||i.getAttribute("datetime")))}setTimeout(t,6e4)}();
